function co_r(a){"object"==typeof ChargeOver?a():setTimeout("co_r("+a+")",250)}function my_callback_function(a,b,c){200==a?(creditCard.card=c.creditcard,billing.clearForm(),Appery.navigateTo("ConfirmPurchasePage")):(Appery("BillingInfoPopupError").text("Error: "+b).show(),setTimeout(function(){Appery("BillingInfoPopupError").hide("close")},1e4))}var addCreditCard=!1,creditCard=[],billing={firstName:"",lastName:"",cardNumber1:"",cardNumber2:"",cardNumber3:"",cardNumber4:"",date:"",cvv:"",company:"",address1:"",address2:"",city:"",country:"",postcode:"",state:"",billingValidation:function(){var a=!1;return this.firstName=Apperyio("BillingInfoFirstNameInput").val(),this.lastName=Apperyio("BillingInfoLastNameInput").val(),this.cardNumber1=Apperyio("BillingInfoCardNumberInput1").val(),this.cardNumber2=Apperyio("BillingInfoCardNumberInput2").val(),this.cardNumber3=Apperyio("BillingInfoCardNumberInput3").val(),this.cardNumber4=Apperyio("BillingInfoCardNumberInput4").val(),this.date=Apperyio("BillingInfoExpiryDate").val(),this.cvv=Appery("BillingInfoCVVInput").val(),this.company=Appery("BillingInfoCompanyInput").val(),this.address1=Appery("BillingInfoAddress1Input").val(),this.address2=Appery("BillingInfoAddress2Input").val(),this.city=Appery("BillingInfoCityInput").val(),this.country=Appery("BillingInfoCountryInput").val(),this.postcode=Appery("BillingInfoPostcodeInput").val(),this.state=Appery("BillingInfoStateSelect").find("option:selected").val(),this.firstName.length&&this.firstName.match(/[A-Za-z-.]+/)||(Appery("BillingInfoFirstNameError").show(),a=!0),this.lastName.length&&this.lastName.match(/[A-Za-z-.]+/)||(Appery("BillingInfoLastNameError").show(),a=!0),this.cardNumber1.length&&this.cardNumber1.match(/^[0-9]+$/)||(Appery("BillingInfoCardNumberError").show(),a=!0),this.cardNumber2.length&&this.cardNumber2.match(/^[0-9]+$/)||(Appery("BillingInfoCardNumberError").show(),a=!0),this.cardNumber3.length&&this.cardNumber3.match(/^[0-9]+$/)||(Appery("BillingInfoCardNumberError").show(),a=!0),this.cardNumber4.length&&this.cardNumber4.match(/^[0-9]+$/)||(Appery("BillingInfoCardNumberError").show(),a=!0),this.date.length||(Appery("BillingInfoExpiryDateError").show(),a=!0),this.cvv.length&&this.cvv.match(/^[0-9]{3,4}$/)||(Appery("BillingInfoCVVError").show(),a=!0),this.address1.length||(Appery("BillingInfoAddressError").show(),a=!0),this.city.length||(Appery("BillingInfoCityError").show(),a=!0),this.country.length||(Appery("BillingInfoCountryError").show(),a=!0),this.postcode.length||(Appery("BillingInfoPostcodeError").show(),a=!0),this.state.length||(Appery("BillingInfoStateError").show(),a=!0),!a},billing:function(){if(this.billingValidation()){co_r(function(){ChargeOver.Core.setup({instance:"whrzt.chargeover.com",token:"R0apsNl1MtEeIFx9b23qCV5YWgk6nwQH"})});var a={customer_id:"1",number:Appery("BillingInfoCardNumberInput1").val()+" "+Appery("BillingInfoCardNumberInput2").val()+" "+Appery("BillingInfoCardNumberInput3").val()+" "+Appery("BillingInfoCardNumberInput4").val(),expdate_month:parseInt($("#ui-datepicker-div .ui-datepicker-month :selected").val())+1,expdate_year:parseInt($("#ui-datepicker-div .ui-datepicker-year :selected").val()),name:Appery("BillingInfoFirstNameInput").val()+" "+Appery("BillingInfoLastNameInput").val(),cvv:Appery("BillingInfoCVVInput").val()||"",address:Appery("BillingInfoAddress1Input").val()||Appery("BillingInfoAddress2Input").val()||"",city:Appery("BillingInfoCityInput").val()||"",state:Appery("BillingInfoStateSelect").find("option:selected").val()||"",postcode:Appery("BillingInfoPostcodeInput").val()||"",country:Appery("BillingInfoCountryInput").val()||""};ChargeOver.CreditCard.tokenize(a,my_callback_function),creditCard.address=(Appery("BillingInfoAddress1Input").val()||Appery("BillingInfoAddress2Input").val())+", "+Appery("BillingInfoCityInput").val()+", "+Appery("BillingInfoStateSelect").find("option:selected").val()+" "+Appery("BillingInfoPostcodeInput").val()+", "+Appery("BillingInfoCountryInput").val()}},hideErrors:function(){Appery("BillingInfoFirstNameError").hide(),Appery("BillingInfoLastNameError").hide(),Appery("BillingInfoCardNumberError").hide(),Appery("BillingInfoExpiryDateError").hide(),Appery("BillingInfoCVVError").hide(),Appery("BillingInfoAddressError").hide(),Appery("BillingInfoCityError").hide(),Appery("BillingInfoCountryError").hide(),Appery("BillingInfoPostcodeError").hide(),Appery("BillingInfoStateError").hide()},clearForm:function(){Appery("BillingInfoFirstNameInput").val(""),Appery("BillingInfoLastNameInput").val(""),Appery("BillingInfoCardNumberInput1").val(""),Appery("BillingInfoCardNumberInput2").val(""),Appery("BillingInfoCardNumberInput3").val(""),Appery("BillingInfoCardNumberInput4").val(""),Appery("BillingInfoExpiryDate").val(""),Appery("BillingInfoCVVInput").val(""),Appery("BillingInfoCompanyInput").val(""),Appery("BillingInfoAddress1Input").val(""),Appery("BillingInfoAddress2Input").val(""),Appery("BillingInfoCityInput").val(""),Appery("BillingInfoCountryInput").val("USA"),Appery("BillingInfoPostcodeInput").val(""),Appery("BillingInfoStateSelect").find('option[value=""]').prop("selected","selected"),Appery("BillingInfoStateSelect").refresh()},thisCardInfo:function(){Appery("ConfirmAmount").text(creditCard.price),creditCard.discountCode&&Appery("ConfirmDiscountCode").text("Discount Code: "+creditCard.discountCode).show(),Appery("ConfirmEmail").text(localStorage.email||sessionStorage.email),addCreditCard?(Appery("ConfirmCardNumber").text(creditCard.card.mask_number),Appery("ConfirmCardType").text(creditCard.card.type_name),Appery("ConfirmExpiryDate").text(creditCard.card.expdate_formatted),Appery("ConfirmName").text(creditCard.card.name),Appery("ConfirmAddress").text(creditCard.address)):(Appery("ConfirmCardNumber").text(creditCard.existCreditCard),Appery("ConfirmCardType").text("Visa"),Appery("ConfirmExpiryDate").text("Dec 2016"),Appery("ConfirmName").text("Joe Black"),Appery("ConfirmAddress").text("Street 123, Anycity, CO 02589, USA"))}},acceptAgreements=$(this).find("#ConfirmPurchasePage_AgreementCheckbox").is(":checked");