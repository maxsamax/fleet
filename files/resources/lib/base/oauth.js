var OAuth;null==OAuth&&(OAuth={}),OAuth.setProperties=function(a,b){if(null!=a&&null!=b)for(var c in b)a[c]=b[c];return a},OAuth.setProperties(OAuth,{percentEncode:function(a){if(null==a)return"";if(a instanceof Array){for(var b="",c=0;c<a.length;++a)""!=b&&(b+="&"),b+=OAuth.percentEncode(a[c]);return b}return a=encodeURIComponent(a),a=a.replace(/\!/g,"%21"),a=a.replace(/\*/g,"%2A"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29")},decodePercent:function(a){return null!=a&&(a=a.replace(/\+/g," ")),decodeURIComponent(a)},getParameterList:function(a){if(null==a)return[];if("object"!=typeof a)return OAuth.decodeForm(a+"");if(a instanceof Array)return a;var b=[];for(var c in a)b.push([c,a[c]]);return b},getParameterMap:function(a){if(null==a)return{};if("object"!=typeof a)return OAuth.getParameterMap(OAuth.decodeForm(a+""));if(a instanceof Array){for(var b={},c=0;c<a.length;++c){var d=a[c][0];void 0===b[d]&&(b[d]=a[c][1])}return b}return a},getParameter:function(a,b){if(!(a instanceof Array))return OAuth.getParameterMap(a)[b];for(var c=0;c<a.length;++c)if(a[c][0]==b)return a[c][1];return null},formEncode:function(a){for(var b="",c=OAuth.getParameterList(a),d=0;d<c.length;++d){var e=c[d][1];null==e&&(e=""),""!=b&&(b+="&"),b+=OAuth.percentEncode(c[d][0])+"="+OAuth.percentEncode(e)}return b},decodeForm:function(a){for(var b=[],c=a.split("&"),d=0;d<c.length;++d){var e=c[d];if(""!=e){var f,g,h=e.indexOf("=");0>h?(f=OAuth.decodePercent(e),g=null):(f=OAuth.decodePercent(e.substring(0,h)),g=OAuth.decodePercent(e.substring(h+1))),b.push([f,g])}}return b},setParameter:function(a,b,c){var d=a.parameters;if(d instanceof Array){for(var e=0;e<d.length;++e)d[e][0]==b&&(void 0===c?d.splice(e,1):(d[e][1]=c,c=void 0));void 0!==c&&d.push([b,c])}else d=OAuth.getParameterMap(d),d[b]=c,a.parameters=d},setParameters:function(a,b){for(var c=OAuth.getParameterList(b),d=0;d<c.length;++d)OAuth.setParameter(a,c[d][0],c[d][1])},completeRequest:function(a,b){null==a.method&&(a.method="GET");var c=OAuth.getParameterMap(a.parameters);null==c.oauth_consumer_key&&OAuth.setParameter(a,"oauth_consumer_key",b.consumerKey||""),null==c.oauth_token&&null!=b.token&&OAuth.setParameter(a,"oauth_token",b.token),null==c.oauth_version&&OAuth.setParameter(a,"oauth_version","1.0"),null==c.oauth_timestamp&&OAuth.setParameter(a,"oauth_timestamp",OAuth.timestamp()),null==c.oauth_nonce&&OAuth.setParameter(a,"oauth_nonce",OAuth.nonce(6)),OAuth.SignatureMethod.sign(a,b)},setTimestampAndNonce:function(a){OAuth.setParameter(a,"oauth_timestamp",OAuth.timestamp()),OAuth.setParameter(a,"oauth_nonce",OAuth.nonce(6))},addToURL:function(a,b){if(newURL=a,null!=b){var c=OAuth.formEncode(b);if(c.length>0){var d=a.indexOf("?");0>d?newURL+="?":newURL+="&",newURL+=c}}return newURL},getAuthorizationHeader:function(a,b){for(var c='OAuth realm="'+OAuth.percentEncode(a)+'"',d=OAuth.getParameterList(b),e=0;e<d.length;++e){var f=d[e],g=f[0];0==g.indexOf("oauth_")&&(c+=","+OAuth.percentEncode(g)+'="'+OAuth.percentEncode(f[1])+'"')}return c},correctTimestampFromSrc:function(a){a=a||"oauth_timestamp";var b=document.getElementsByTagName("script");if(null!=b&&b.length){var c=b[b.length-1].src;if(c){var d=c.indexOf("?");if(!(0>d)){parameters=OAuth.getParameterMap(OAuth.decodeForm(c.substring(d+1)));var e=parameters[a];null!=e&&OAuth.correctTimestamp(e)}}}},correctTimestamp:function(a){OAuth.timeCorrectionMsec=1e3*a-(new Date).getTime()},timeCorrectionMsec:0,timestamp:function(){var a=(new Date).getTime()+OAuth.timeCorrectionMsec;return Math.floor(a/1e3)},nonce:function(a){for(var b=OAuth.nonce.CHARS,c="",d=0;a>d;++d){var e=Math.floor(Math.random()*b.length);c+=b.substring(e,e+1)}return c}}),OAuth.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",OAuth.declareClass=function(a,b,c){var d=a[b];if(a[b]=c,null!=c&&null!=d)for(var e in d)"prototype"!=e&&(c[e]=d[e]);return c},OAuth.declareClass(OAuth,"SignatureMethod",function(){}),OAuth.setProperties(OAuth.SignatureMethod.prototype,{sign:function(a){var b=OAuth.SignatureMethod.getBaseString(a),c=this.getSignature(b);return OAuth.setParameter(a,"oauth_signature",c),c},initialize:function(a,b){var c;c=null!=b.accessorSecret&&a.length>9&&"-Accessor"==a.substring(a.length-9)?b.accessorSecret:b.consumerSecret,this.key=OAuth.percentEncode(c)+"&"+OAuth.percentEncode(b.tokenSecret)}}),OAuth.setProperties(OAuth.SignatureMethod,{sign:function(a,b){var c=OAuth.getParameterMap(a.parameters).oauth_signature_method;(null==c||""==c)&&(c="HMAC-SHA1",OAuth.setParameter(a,"oauth_signature_method",c)),OAuth.SignatureMethod.newMethod(c,b).sign(a)},newMethod:function(a,b){var c=OAuth.SignatureMethod.REGISTERED[a];if(null!=c){var d=new c;return d.initialize(a,b),d}var e=new Error("signature_method_rejected"),f="";for(var g in OAuth.SignatureMethod.REGISTERED)""!=f&&(f+="&"),f+=OAuth.percentEncode(g);throw e.oauth_acceptable_signature_methods=f,e},REGISTERED:{},registerMethodClass:function(a,b){for(var c=0;c<a.length;++c)OAuth.SignatureMethod.REGISTERED[a[c]]=b},makeSubclass:function(a){var b=OAuth.SignatureMethod,c=function(){b.call(this)};return c.prototype=new b,c.prototype.getSignature=a,c.prototype.constructor=c,c},getBaseString:function(a){var b,c=a.action,d=c.indexOf("?");if(0>d)b=a.parameters;else{b=OAuth.decodeForm(c.substring(d+1));for(var e=OAuth.getParameterList(a.parameters),f=0;f<e.length;++f)b.push(e[f])}return OAuth.percentEncode(a.method.toUpperCase())+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(c))+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(b))},normalizeUrl:function(a){var b=OAuth.SignatureMethod.parseUri(a),c=b.protocol.toLowerCase(),d=b.authority.toLowerCase(),e="http"==c&&80==b.port||"https"==c&&443==b.port;if(e){var f=d.lastIndexOf(":");f>=0&&(d=d.substring(0,f))}var g=b.path;return g||(g="/"),c+"://"+d+g},parseUri:function(a){for(var b={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},c=b.parser.strict.exec(a),d={},e=14;e--;)d[b.key[e]]=c[e]||"";return d},normalizeParameters:function(a){if(null==a)return"";for(var b=OAuth.getParameterList(a),c=[],d=0;d<b.length;++d){var e=b[d];"oauth_signature"!=e[0]&&c.push([OAuth.percentEncode(e[0])+" "+OAuth.percentEncode(e[1]),e])}c.sort(function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0});for(var f=[],g=0;g<c.length;++g)f.push(c[g][1]);return OAuth.formEncode(f)}}),OAuth.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],OAuth.SignatureMethod.makeSubclass(function(a){return this.key})),OAuth.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],OAuth.SignatureMethod.makeSubclass(function(a){b64pad="=";var b=b64_hmac_sha1(this.key,a);return b}));try{OAuth.correctTimestampFromSrc()}catch(e){}