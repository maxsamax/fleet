!function(a,b){function c(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e})}c(),a.widget("mobile.carousel",a.mobile.widget,{options:{indicators:null,indicatorsListClass:"ui-carousel-indicators",animationDuration:250,useLegacyAnimation:!1,showIndicator:!0,startFrom:0,showTitle:!0,titleIsText:!0,usejQMSwipes:!1,theme:"a",createIndicator:null,passOnSwipeEvents:!1,titleBuildIn:!0,createTitle:null,enabled:!0,disabled:!1},_list:null,_counter:0,_sliding:!1,_sliding_type:null,_resizing:null,active:null,__rerender_indicators:!0,_create:function(){this.options=a.extend(this.options,this.element.data("options")),this.options=a.extend(this.options,this.element.data()),this.element.addClass("ui-carousel ui-carousel-theme-"+this.options.theme)},_setOptions:function(c){c.theme!==b&&(this.element.removeClass("ui-carousel-theme-"+this.options.theme),this.element.addClass("ui-carousel-theme-"+c.theme)),c.indicators!==b&&(this.__rerender_indicators=!0),c.showIndicator!==b&&!!c.showIndicator!=this.options.indicators&&a(this.options.indicators).toggle(!!c.showIndicator),c.enabled!==b&&!!c.enabled!=this.options.enabled&&this._setOption("disabled",!c.enabled),c.disabled!==b&&!!c.disabled!=this.options.disabled&&this._setOption("enabled",!c.enabled),this.options=a.extend(this.options,c)},_init:function(){if(null===this.options.createTitle&&(this.options.createTitle=this._create_title.bind(this)),!this.options.useLegacyAnimation){this._animation_meta=this._mainAnimationEnd;var a=navigator.userAgent.match(/(iPad|iPhone);.*CPU.*OS 7_0 .*(Safari)?/i);null!==a&&"Safari"!=a[2]&&(this._animation_meta=this._ios7Webview_AnimationEnd);var c=this.element.get(0);c.style.webkitTransition!==b?this._animation=this._animation_meta("webkitTransitionEnd"):c.style.oTransition!==b?this._animation=this._animation_meta("oTransitionEnd"):c.style.otransition!==b?this._animation=this._animation_meta("otransitionend"):c.style.mozTransition!==b?this._animation=this._animation_meta("transitionend"):c.style.transition!==b&&(this._animation=this._animation_meta("transitionend"))}this.options.usejQMSwipes&&(this.bindEvents=this.__jqm_bindEvents,this._preBindEvents()),this._sliding=!1,this.__index=parseInt(this.options.startFrom,10)||0,this.bindEvents(),this.refresh(),this.__rerender_indicators=!1},_ios7Webview_AnimationEnd:function(a){return function(a,b,c,d,e){var f=this._list[0].style;f.webkitTransitionDuration=f.transitionDuration=this.options.animationDuration+"ms",f.transform=f.webkitTransform="translate(-"+this.__offsets[this.__index]+"px,0)translateZ(0)",setTimeout(function(){e({data:{next:next.id,active:active.id}})},this.options.animationDuration)}},_mainAnimationEnd:function(a){return function(b,c,d){var e=this.options.animationDuration;c?this._list.one(a,{next:c[0].id,active:b[0].id},d):e=1;var f=this._list[0].style;f.webkitTransitionDuration=f.MozTransitionDuration=f.msTransitionDuration=f.OTransitionDuration=f.transitionDuration=e+"ms",f.webkitTransform=f.msTransform=f.MozTransform=f.OTransform="translateX(-"+this.__offsets[this.__index]+"px)"}},_UID:function(){return this._counter++,this.uuid+"-"+this._counter},__enabledFramesList:function(c){c=c==b?!0:!1;var d=a("*[data-type='image'], *[data-type='html']",this._list);return c?d.filter(":visible"):d},_update_items_list:function(){return this._list=a(".ui-carousel-items",this.element),a("*[data-type='image'], *[data-type='html'], .ui-carousel-item",this._list).filter(":visible")},refresh:function(b){var c;return a(this.options.indicators).html(""),this._initIndicators(),b&&a.isArray(b)?(this.clear(),a.map(b,this._addJSON.bind(this)),c=this._update_items_list()):(c=this._update_items_list(),c.each(this._render_frame.bind(this))),this.length=function(a){return function(){return a}}(c.filter(":visible").length),this.__enabledFramesList=function(a,b){return function(c){return c?b:a}}(c,c.filter(":visible")),this.__offsets=new Array(this.length()),this._list.find(".ui-carousel-item").each(function(b,c){a(c).data("itemIndex",b)}),setTimeout(function(){this._onresize(),this.to(this.__index,!0)}.bind(this),0),this},unBindEvents:function(){a.isFunction(this.__swipe)&&(this.element.off("swipeleft",this.__swipeleft),this.element.off("swiperight",this.__swiperight),this.element.off("swipe",this.__swipe),this.element.find(".ui-right-arrow").off("click",this.__swipeleft),this.element.find(".ui-left-arrow").off("click",this.__swiperight))},_onresize:function(){this._width=this.element.innerWidth();var a=this.length(),b=this.__enabledFramesList(!0);this._list[0].style.width=this._width*(a+1)+"px";for(var c=a-1;c>-1;c--)this.__offsets[c]=c*this._width,b[c].style.width=this._width+"px",b[c].style.left=this.__offsets[c]+"px";this._animation()},_preBindEvents:function(){this.__swiperight=this.previous.bind(this),this.__swipeleft=this.next.bind(this),this.__swipe=function(a){return this.options.passOnSwipeEvents?!this._sliding:!1}.bind(this)},bindEvents:function(){function c(a){var c={},f=a.data.self,g=f._touch={};c="undefined"!=typeof a.originalEvent.touches?a.originalEvent.touches[0]:a.originalEvent,g.start={x:c.pageX,y:c.pageY,time:+new Date},g.isScrolling=b,g.delta={},f.element.on("MSPointerMove PointerMove touchmove mousemove",{self:f},d),f.element.on("MSPointerOut PointerOut touchend mouseup",{self:f},e)}function d(a){if(!("undefined"!=typeof a.originalEvent.touches&&a.originalEvent.touches.length>1||a.originalEvent.scale&&1!==a.originalEvent.scale)){var b={},c=a.data.self,d=c._touch;b="undefined"!=typeof a.originalEvent.touches?a.originalEvent.touches[0]:a.originalEvent,d.delta={x:b.pageX-d.start.x,y:b.pageY-d.start.y},"undefined"==typeof d.isScrolling&&(d.isScrolling=!!(d.isScrolling||Math.abs(d.delta.x)<Math.abs(d.delta.y))),d.isScrolling||a.preventDefault()}}function e(a){var b=a.data.self,c=b._touch,f=+new Date-c.start.time,g=c.delta.x<0?"next":"previous";isValidSlide=!1,isValidSlide=Number(f)<250&&Math.abs(c.delta.x)>20||Math.abs(c.delta.x)>b._width/2,!c.isScrolling&&isValidSlide&&b[g].call(b),b.element.off("touchmove MSPointerMove PointerMove mousemove",d),b.element.off("touchend MSPointerUp PointerUp mouseup",e)}this.element.on("touchstart MSPointerDown PointerDown mousedown",{self:this},c),a(window).on("resize",this._onresize.bind(this)),a(window).on("load",this._onresize.bind(this)),this.unBindEvents=function(){this.element.off("touchstart MSPointerDown PointerDown mousedown",c)}},__jqm_bindEvents:function(){a(window).on("resize",this._onresize.bind(this)),this.element.on({swiperight:this.__swiperight,swipeleft:this.__swipeleft,swipe:this.__swipe}),this.element.find(".ui-right-arrow").on("click",this.__swipeleft),this.element.find(".ui-left-arrow").on("click",this.__swiperight)},_update_from_attr:function(b){var c=b.data();return b.removeData(),a.each("title imageUrl type".split(" "),function(a,c){b.data(c)}),b.data(a.extend({},c,b.data())),b.data()},_initIndicators:function(){this.options.showIndicator?(null===this.options.indicators?(this.options.indicators=a("<div></div>"),this.options.indicators.appendTo(this.element)):"string"==typeof this.options.indicators&&(this.options.indicators=a(this.options.indicators)),this.options.indicators.addClass(this.options.indicatorsListClass),this.options.indicators.addClass(this.options.indicatorsListClass+"-theme-"+this.options.theme),null===this.options.createIndicator&&(this.options.createIndicator=this._createIndicator.bind(this))):this.options.createIndicator=function(){}},_render_frame:function(c,d,e){var f,g,h=a(d),i=e||this._update_from_attr(h),j=h.attr("id")||this._UID(),k=h.data("_processed")===b;switch(k&&(h.removeClass("ui-carousel-active"),h.addClass("ui-carousel-item").attr("id",j)),i.type){case"image":f=this._wraperBox(h,i.title||""),this._load_image(i.imageUrl,f,h);break;case"html":this._load_html(h,i.title||"")}if(this.options.showIndicator){h.data("_processed",j);var l=this._UID();g=this.options.createIndicator(this.options.indicators,i.title||""),g.attr("id",l).data("targetElement",j),h.data("indicator",l),g.on("show activate",function(b){a(this).addClass("ui-carousel-indicator-active ui-radio-on")}).on("hide deactivate",function(b){a(this).removeClass("ui-carousel-indicator-active ui-radio-on")}),h.on("hide",function(b){a("#"+a(this).data("indicator")).trigger("deactivate")}).on("show",function(b){a("#"+a(this).data("indicator")).trigger("activate")}),g.on("click",{to:this.to.bind(this)},function(b){var c="#"+a(this).data("targetElement");b.data.to(a(c).data("itemIndex"))})}return h.data("_processed",j)},_wraperBox:function(b,c){var d;return d=0===a(".ui-carousel-box",b).length?a("<div></div>").addClass("ui-carousel-box").appendTo(b):a(".ui-carousel-box",b),this.options.showTitle&&this.options.createTitle(c,b),d},_create_title:function(b,c){var d=a(".ui-carousel-title",c),e=this.options.titleIsText?"text":"html";return d.length>0?this.options.titleBuildIn?d.children().hasClass("ui-carousel-title-inside")?a(".ui-carousel-title-inside",d)[e](b):(d.html('<div class="ui-carousel-title-inside"></div>'),d.children()[e](b)):(d.children().hasClass("ui-carousel-title-inside")&&d.children().remove(),d[e](b)):(this.options.titleBuildIn?(d=a('<div class="ui-carousel-title"><div class="ui-carousel-title-inside"></div></div>'),d.children()[e](b)):(d=a('<div class="ui-carousel-title"></div>'),d[e](b)),d.appendTo(c)),d},_load_image:function(b,c,d){var e,f=function(){};return a("img",c).length>0&&(e=a("img:first",c),e.attr("src")==b)?void d.trigger("ready",{item:d}):(e=new Image,e.onload=function(){c.empty(),c.css("background-image","url("+b+")"),c.data("imageUrl",b),d.trigger("ready",{item:d})},e.onerror=f,e.onabort=f,void(e.src=b))},_load_html:function(b,c){var d,e;return 0!==a(".ui-carousel-box",b).length?(this._wraperBox(b,c),void b.trigger("ready")):(d=b.children().detach(),b.html(""),e=this._wraperBox(b,c),e.append(d),void b.trigger("ready"))},_addJSON:function(b){var c=a("<div></div>");return arguments.length>1&&(b="object"==typeof arguments[0]?arguments[0]:arguments[1]),b.imageUrl="image"==b.type?b.content:"",c.data({type:b.type||"html",title:b.title||"",imageUrl:b.imageUrl||""}),c.html("image"==b.type?"":b.content||""),c.appendTo(this._list),b.onReady&&c.on("ready",b.onReady),b.onShow&&c.on("show",b.onShow),b.onHide&&c.on("hide",b.onHide),c=this._render_frame(0,c)},add:function(b,c,d,e,f,g){var h=!1;return a.isArray(b)?(a.each(b,this._addJSON.bind(this)),h=this):h=a.isPlainObject(b)?this._addJSON(b):this._addJSON({type:b,content:d,title:c,onReady:e,onShow:f}),h},next:function(){return this._sliding?!1:(this.element.trigger("beforenext"),this.to(this._circle(this.__index+1)),!!this.options.passOnSwipeEvents)},previous:function(){return this._sliding?!1:(this.element.trigger("beforeprev"),this.to(this._circle(this.__index-1)),!!this.options.passOnSwipeEvents)},_circle:function(a){return(this.length()+a%this.length())%this.length()},to:function(a,b){return this.options.disabled||!this.options.enabled?!1:(a=parseInt(a,10)||0,this.__index==a&&"undefined"==typeof b?!1:(this.__index=a,this.element.trigger("goto",this.__index),this.slide(!1,this.__enabledFramesList().eq(this.__index)),this))},slide:function(b,c){if(!this._sliding&&!this.options.disabled&&this.options.enabled){-1===["next","prev"].indexOf(b)&&(b=0===a(c).nextAll(".ui-carousel-active").length?"next":"prev");var d=this.__enabledFramesList();if(this.__index=c.data("itemIndex"),this.active=d.filter(".ui-carousel-active"),this.active.attr("id")==c.attr("id"))return this.element.trigger("slidingcanceled"),a("#"+this.active.data("indicator"),this.element).trigger("activate"),!1;if(0===this.active.length)return c.addClass("ui-carousel-active").trigger("show"),this.active=c,!0;c.trigger("beforeshow"),this.element.trigger("slidingstart",b);var e=function(b){a("#"+b.data.active).removeClass("ui-carousel-active").trigger("hide"),this.active=a("#"+b.data.next),this.active.addClass("ui-carousel-active").trigger("show"),this._sliding=!1,this.element.trigger("slidingdone",this._sliding_type)};return this._animation(this.active,c,e.bind(this)),this._sliding=!0,this._sliding_type=b,!0}},_animation:function(a,b,c){b&&this._list.animate({left:-1*this.__offsets[this.__index]},{duration:this.options.animationDuration,complete:c.bind(this,{data:{active:a.attr("id"),next:b.attr("id")}})})},getFrame:function(a){var b=this._list.find(".ui-carousel-item").eq(a);return 0===b.length?!1:b},eachItem:function(a){return this._list.find(".ui-carousel-item").each(a),this},remove:function(c,d){return"object"==typeof c?(d=a(c),c=d.data("itemIndex")-0):(c=parseInt(c,10),d===b?d=this._list.find(".ui-carousel-item").eq(c):c=d.data("itemIndex")-0),c==this.__index?(d.one("hide",this.remove.bind(this,d)),this.next()):(this._remove(c,d),this.refresh()),this},_remove:function(b,c){var d=a(c),e=a("#"+d.data("indicator"));d.trigger("itemremove").off(),e.trigger("itemremove").off(),e.remove(),d.remove()},clear:function(b){this.element.trigger("clear_all"),a(".ui-carousel-item",this.element).each(this._remove.bind(this)),this.__index=0,this.refresh()},_createIndicator:function(b,c){var d=a("<div></div>");return d.addClass("ui-carousel-indicator"),d.attr("title",c),d.appendTo(b),d}}),a(document).bind("pagecontainershow pageshow",function(b){a(document).trigger("ui-carouselbeforecreate");var c=a(":jqmData(role='carousel')",b.target).carousel();return a(":jqmData(role='carousel')",b.target).carousel("bindEvents"),c}).bind("pagehide",function(b){return a(":jqmData(role='carousel')",b.target).carousel("unBindEvents")})}(jQuery);